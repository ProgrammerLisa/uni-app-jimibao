(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tabBar/exchange/exchange"],{"1e82":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){t.payShow=!1})},i=[];n.d(e,"a",function(){return a}),n.d(e,"b",function(){return i})},"461a":function(t,e,n){},"4b1b":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=s(n("a34a")),i=s(n("e137")),r=(s(n("7121")),s(n("2932")));function s(t){return t&&t.__esModule?t:{default:t}}function c(t,e,n,a,i,r,s){try{var c=t[r](s),u=c.value}catch(o){return void n(o)}c.done?e(u):Promise.resolve(u).then(a,i)}function u(t){return function(){var e=this,n=arguments;return new Promise(function(a,i){var r=t.apply(e,n);function s(t){c(r,a,i,s,u,"next",t)}function u(t){c(r,a,i,s,u,"throw",t)}s(void 0)})}}var o=function(){return n.e("components/y-confirm/y-pay-confirm").then(n.bind(null,"8e27"))},l=function(){return Promise.all([n.e("common/vendor"),n.e("components/mescroll-uni/mescroll-uni")]).then(n.bind(null,"5d2a"))},f=function(){return n.e("components/uni-icon/uni-icon").then(n.bind(null,"d227"))},d=function(){return n.e("components/y-tabs/y-tabs").then(n.bind(null,"216d"))},h={components:{uniMescroll:l,yTabs:d,yPayConfirm:o,uniIcon:f},data:function(){return{avatar:r.default,active:0,tabList:[{title:"收单",dataList:[]},{title:"出单",dataList:[]}],info:{curBuyNum:0,curSellNum:0,curPrice:{beginTime:0,price:0}},payShow:!1,pay:{},balance:"",password:"",timer:"",mescroll:null,downOption:{use:!0,auto:!0},upOption:{use:!0,auto:!0,isLock:!1,page:{num:0,size:10},noMoreSize:9,empty:{tip:"暂无相关数据"}}}},onReachBottom:function(){this.mescroll&&this.mescroll.onReachBottom()},onPageScroll:function(t){this.mescroll&&this.mescroll.onPageScroll(t)},onNavigationBarButtonTap:function(e){"order"===e.navType?t.navigateTo({url:"/pages/template/profile/topList-order/topList-order"}):t.navigateTo({url:"/pages/template/exchange/send/send"})},onShow:function(){var e=this;this.initList(),this.getData(),this.timer=setInterval(function(){e.getData()},3e4);var n=this;t.onSocketMessage(function(t){"CHAT"===JSON.parse(t.data).type&&n.noReadCount()})},onHide:function(){var t=this;clearInterval(t.timer)},watch:{payShow:function(t){this.password=""}},methods:{getData:function(){var t=u(a.default.mark(function t(){var e,n;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i.default.exchangeInfo();case 2:return e=t.sent,e.success&&(this.info=e.data),t.next=6,i.default.AccountBalance();case 6:n=t.sent,n.success&&(this.balance=n.data.balance);case 8:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),initList:function(){var t=u(a.default.mark(function t(){var e;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i.default.exchangeList({sign:this.active+1});case 2:e=t.sent,e.success&&(this.tabList[this.active].dataList=e.data.list);case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),noReadCount:function(){var e=u(a.default.mark(function e(){var n,r;return a.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.default.unRead();case 2:n=e.sent,n.success&&n.data>0&&(r=n.data<100?n.data.toString():"99+",t.setTabBarBadge({index:3,text:r}));case 4:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}(),changeTabs:function(){var t=u(a.default.mark(function t(e){return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:this.active=e;case 1:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),openPay:function(t){this.pay=t,this.payShow=!0},exchange:function(){var e=u(a.default.mark(function e(){var n,r;return a.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.password){e.next=3;break}return t.showToast({title:"请输入密码",icon:"none"}),e.abrupt("return",!1);case 3:return n=1===this.pay.sign?"sell":"buy",e.next=6,i.default.exchange({type:n,orderid:this.pay.orderid,owner:this.pay.firmid,tradepassword:this.password});case 6:r=e.sent,this.payShow=!1,r.success&&(this.existCheck(),t.showToast({title:"兑换成功"}));case 9:case"end":return e.stop()}},e,this)}));function n(){return e.apply(this,arguments)}return n}(),existCheck:function(){var t=this;this.tabList[this.active].dataList.forEach(function(e){(t.pay=e)&&(e.exist=!0)})},goSearch:function(){t.navigateTo({url:"/pages/template/exchange/search/search"})},mescrollInit:function(t){this.mescroll=t},downCallback:function(t){t.resetUpScroll()},upCallback:function(){var t=u(a.default.mark(function t(e){var n,r,s,c,u,o,l=this;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:n=e.num,r=e.size,t.t0=this.active,t.next=0===t.t0?5:1===t.t0?7:9;break;case 5:return s=1,t.abrupt("break",9);case 7:return s=2,t.abrupt("break",9);case 9:return t.next=11,i.default.exchangeList({page:n,size:r,sign:s});case 11:c=t.sent,c.success?(u=c.data.list,c.data.total,o=c.data.hasNextPage,setTimeout(function(){e.endSuccess(u.length,o),1===e.num&&(l.tabList[l.active].dataList=[]),l.tabList[l.active].dataList=l.tabList[l.active].dataList.concat(u)},500)):e.endErr();case 13:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()}};e.default=h}).call(this,n("6e42")["default"])},9124:function(t,e,n){"use strict";n.r(e);var a=n("1e82"),i=n("bbbf");for(var r in i)"default"!==r&&function(t){n.d(e,t,function(){return i[t]})}(r);n("fbc6");var s=n("2877"),c=Object(s["a"])(i["default"],a["a"],a["b"],!1,null,"0030f938",null);e["default"]=c.exports},bbbf:function(t,e,n){"use strict";n.r(e);var a=n("4b1b"),i=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,function(){return a[t]})}(r);e["default"]=i.a},fbc6:function(t,e,n){"use strict";var a=n("461a"),i=n.n(a);i.a}},[["b1b0","common/runtime","common/vendor"]]]);