(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tabBar/chat/chat"],{"0b7a":function(t,n,e){"use strict";e.r(n);var a=e("d4e9"),r=e.n(a);for(var o in a)"default"!==o&&function(t){e.d(n,t,function(){return a[t]})}(o);n["default"]=r.a},"2acf":function(t,n,e){},"6f7f":function(t,n,e){"use strict";var a=e("2acf"),r=e.n(a);r.a},7713:function(t,n,e){"use strict";var a=function(){var t=this,n=t.$createElement;t._self._c},r=[];e.d(n,"a",function(){return a}),e.d(n,"b",function(){return r})},"906a":function(t,n,e){"use strict";e.r(n);var a=e("7713"),r=e("0b7a");for(var o in r)"default"!==o&&function(t){e.d(n,t,function(){return r[t]})}(o);e("6f7f");var u=e("2877"),i=Object(u["a"])(r["default"],a["a"],a["b"],!1,null,"019a0cbe",null);n["default"]=i.exports},d4e9:function(t,n,e){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=u(e("a34a")),r=u(e("7121")),o=u(e("2932"));function u(t){return t&&t.__esModule?t:{default:t}}function i(t,n,e,a,r,o,u){try{var i=t[o](u),c=i.value}catch(s){return void e(s)}i.done?n(c):Promise.resolve(c).then(a,r)}function c(t){return function(){var n=this,e=arguments;return new Promise(function(a,r){var o=t.apply(n,e);function u(t){i(o,a,r,u,c,"next",t)}function c(t){i(o,a,r,u,c,"throw",t)}u(void 0)})}}var s=function(){return e.e("components/uni-icon/uni-icon").then(e.bind(null,"d227"))},l=function(){return Promise.all([e.e("common/vendor"),e.e("components/mescroll-uni/mescroll-uni")]).then(e.bind(null,"5d2a"))},d=function(){return e.e("components/min-badge/min-badge").then(e.bind(null,"38a8"))},f={components:{uniIcon:s,uniMescroll:l,minBadge:d},data:function(){return{mescroll:null,downOption:{use:!0,auto:!0},upOption:{use:!0,auto:!0,isLock:!1,page:{num:0,size:10},noMoreSize:9,empty:{tip:"暂无相关数据"}},dataList:[],defaultAvatar:o.default,imageUrl:""}},onReachBottom:function(){this.mescroll&&this.mescroll.onReachBottom()},onPageScroll:function(t){this.mescroll&&this.mescroll.onPageScroll(t)},onLoad:function(){this.imageUrl=this.$imageUrl},onShow:function(){var n=this;n.noReadCount(),t.onSocketMessage(function(t){"CHAT"===JSON.parse(t.data).type&&(n.dataList.forEach(function(n){JSON.parse(t.data).sender===n.bfirmid&&n.unread++}),n.noReadCount())})},methods:{goRoom:function(){var n=c(a.default.mark(function n(e){return a.default.wrap(function(n){while(1)switch(n.prev=n.next){case 0:t.setStorage({key:"chat-id",data:e.bfirmid,success:function(){t.navigateTo({url:"/pages/tabBar/chat/room"})}});case 1:case"end":return n.stop()}},n,this)}));function e(t){return n.apply(this,arguments)}return e}(),noReadCount:function(){var n=c(a.default.mark(function n(){var e,o;return a.default.wrap(function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,r.default.unRead();case 2:e=n.sent,e.success&&(e.data>0?(o=e.data<100?e.data.toString():"99+",t.setTabBarBadge({index:3,text:o})):t.removeTabBarBadge({index:3}));case 4:case"end":return n.stop()}},n,this)}));function e(){return n.apply(this,arguments)}return e}(),mescrollInit:function(t){this.mescroll=t},downCallback:function(t){t.resetUpScroll()},upCallback:function(){var t=c(a.default.mark(function t(n){var e,o,u,i,c,s,l=this;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e=n.num,o=n.size,t.t0=this.active,t.next=0===t.t0?5:1===t.t0?7:9;break;case 5:return u=1,t.abrupt("break",9);case 7:return u=2,t.abrupt("break",9);case 9:return t.next=11,r.default.contacts({page:e,size:o,sign:u});case 11:i=t.sent,i.success?(c=i.data.list,i.data.total,s=i.data.hasNextPage,setTimeout(function(){n.endSuccess(c.length,s),1===n.num&&(l.dataList=[]),l.dataList=l.dataList.concat(c)},500)):n.endErr();case 13:case"end":return t.stop()}},t,this)}));function n(n){return t.apply(this,arguments)}return n}(),setTabBarBadge:function(){this.hasSetTabBarBadge?t.removeTabBarBadge({index:2}):t.setTabBarBadge({index:2,text:"2"}),this.hasSetTabBarBadge=!this.hasSetTabBarBadge}}};n.default=f}).call(this,e("6e42")["default"])}},[["c1ff","common/runtime","common/vendor"]]]);