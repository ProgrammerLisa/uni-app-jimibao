(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/template/profile/real-name/real-name"],{"1e50":function(e,t,n){"use strict";var a=n("6b9f"),i=n.n(a);i.a},"5a5d":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=s(n("a34a")),i=s(n("e137")),r=n("2574"),u=s(n("c3b0"));function s(e){return e&&e.__esModule?e:{default:e}}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){c(e,t,n[t])})}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t,n,a,i,r,u){try{var s=e[r](u),o=s.value}catch(c){return void n(c)}s.done?t(o):Promise.resolve(o).then(a,i)}function f(e){return function(){var t=this,n=arguments;return new Promise(function(a,i){var r=e.apply(t,n);function u(e){l(r,a,i,u,s,"next",e)}function s(e){l(r,a,i,u,s,"throw",e)}u(void 0)})}}var m=function(){return n.e("components/mpvue-picker/mpvuePicker").then(n.bind(null,"8b54"))},h=function(){return n.e("components/uni-icon/uni-icon").then(n.bind(null,"d227"))},d=function(){return n.e("components/uni-popup/uni-popup").then(n.bind(null,"5589"))},p=function(){return n.e("components/uni-cpimg/uni-cpimg").then(n.bind(null,"b5dd"))},g={components:{mpvuePicker:m,uniIcon:h,yPopup:d,uniCpimg:p},data:function(){return{info:{},bankList:[],dataList:[],form:{bankname:""},imageUrl:"",themeColor:"#007AFF",cityPickerValueDefault:[0,0,1],changeImageShow:!1,changeImageList:[{title:"重选",value:0},{title:"查看照片",value:1}]}},onShow:function(){this.getBank()},methods:{cpimgOk:function(e){console.log(e," at pages\\template\\profile\\real-name\\real-name.vue:105")},cpimgErr:function(){},getData:function(){var e=f(a.default.mark(function e(){var t,n;return a.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.default.home();case 2:t=e.sent,t.success&&(n=this,this.info=t.data.TFirmPO,this.dataList=[{label:"姓名",value:t.data.TFirmPO.name},{label:"身份证",value:t.data.TFirmPO.idcard},{label:"银行名称",value:n.getBankName(t.data.TFirmPO.bankaccount,t.data.TFirmPO.bankid)},{label:"银行卡",value:t.data.TFirmPO.bankaccount?t.data.TFirmPO.bankaccount:"无"},{label:"支付宝",value:t.data.TFirmPO.alipayid},{label:"微信",value:t.data.TFirmPO.wechatid}]);case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),getBank:function(){var e=f(a.default.mark(function e(){var t;return a.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.default.bank();case 2:t=e.sent,t.success&&(this.bankList=t.data.map(function(e){return{label:e.bankname,value:e.bankid}}),this.getData());case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),getBankName:function(e,t){if(!e)return"无";this.bankList.forEach(function(e){if(t===e.value)return e.label})},showSinglePicker:function(){this.$refs.mpvuePicker.show()},onCancel:function(){},onConfirm:function(e){this.form.bankname=e.label,this.form.bankid=e.value},judgeChoose:function(){this.imageUrl?this.changeImageShow=!0:this.chooseImage()},getSubIndex:function(e){switch(this.changeImageShow=!1,e.value){case 0:this.chooseImage();break;case 1:this.checkImage()}},chooseImage:function(){var t=this,n=(new Date).getTime();e.chooseImage({count:1,sizeType:["compressed"],sourceType:["camera"],success:function(a){t.filePath=a.tempFilePaths[0];var i="_doc/self".concat(n,".jpg");plus.zip.compressImage({src:a.tempFilePaths[0],dst:i,width:"20%",quality:30},function(n){(0,r.pathToBase64)(i).then(function(e){console.log(e.length," at pages\\template\\profile\\real-name\\real-name.vue:192"),t.imageUrl=e}),e.showToast({icon:"loading",title:"解析图片中 请稍等几秒.."})},function(t){e.showToast({icon:"none",title:t.message})})},fail:function(t){e.showToast({title:"取消选择",icon:"none"})}})},checkImage:function(){var t=this;e.previewImage({current:t.filePath,urls:[t.filePath],indicator:"none",fail:function(t){e.showToast({title:"无法打开图片",icon:"none"})}})},formSubmit:function(t){if(this.checkForm(t.detail.value)){if(!this.imageUrl)return e.showToast({title:"请上传相关图片",icon:"none"}),!1;var n=this.imageUrl.substring(23),a=o({},t.detail.value,{bankid:this.form.bankid,base64Str:n});console.log(n," at pages\\template\\profile\\real-name\\real-name.vue:239"),console.log(n.length," at pages\\template\\profile\\real-name\\real-name.vue:240"),this.sendForm(a)}},sendForm:function(){var t=f(a.default.mark(function t(n){var r;return a.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i.default.realName(n);case 2:r=t.sent,r.success&&(e.showToast({title:"认证成功"}),setTimeout(function(){e.navigateBack()},500));case 4:case"end":return t.stop()}},t,this)}));function n(e){return t.apply(this,arguments)}return n}(),checkForm:function(t){var n,a=this;for(var i in t){var r=a.checkItem(i,t[i]);if(!r.status)return e.showToast({title:r.message,icon:"none"}),!1;n=!0}return n},checkItem:function(e,t){switch(e){case"name":return t?t.length<2||t.length>15?{status:!1,message:"姓名不正确"}:{status:!0}:{status:!1,message:"请输入姓名"};case"idcard":return t?u.default.IdCard.test(t)?{status:!0}:{status:!1,message:"身份证号码格式不正确"}:{status:!1,message:"身份证不能为空"};case"bankname":return t&&!this.form.bankaccount?{status:!1,message:"请输入银行卡号"}:{status:!0};case"bankaccount":return t&&!u.default.bankCodeReg.test(t)?{status:!1,message:"银行卡号格式不正确"}:{status:!0};case"alipayid":return t?{status:!0}:{status:!1,message:"支付宝不能为空"};case"wechatid":return t?u.default.wechat.test(t)||u.default.phone.test(t)?{status:!0}:{status:!1,message:"微信格式不正确"}:{status:!1,message:"微信不能为空"}}}}};t.default=g}).call(this,n("6e42")["default"])},"6b9f":function(e,t,n){},"807e":function(e,t,n){"use strict";n.r(t);var a=n("5a5d"),i=n.n(a);for(var r in a)"default"!==r&&function(e){n.d(t,e,function(){return a[e]})}(r);t["default"]=i.a},b71f:function(e,t,n){"use strict";n.r(t);var a=n("b767"),i=n("807e");for(var r in i)"default"!==r&&function(e){n.d(t,e,function(){return i[e]})}(r);n("1e50");var u=n("2877"),s=Object(u["a"])(i["default"],a["a"],a["b"],!1,null,"7267f439",null);t["default"]=s.exports},b767:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.changeImageShow=!1})},i=[];n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i})}},[["eba8","common/runtime","common/vendor"]]]);